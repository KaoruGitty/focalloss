# 損失関数比較：3クラス分類における数式定義

正解クラスの確率を $P_{correct}$、間違いクラスの確率を $P_{wrong}$ と定義します。

---

## 1. 通常のクロスエントロピー (Standard CE)
正解クラスの確率のみを最大化する標準的な形式です。

$$Loss_{CE} = - \log(P_{correct})$$

---

## 2. 旧型コスト考慮損失 (Old CSL)
間違いクラスを直接対数に入れた形式。$a < b$ の時に学習が崩壊します。

$$Loss_{old} = -(a \log P_{correct} + \sum b_j \log P_{wrong, j})$$

> **欠点**: $P_{wrong} \to 1$（間違い100%）のとき、$\log P_{wrong}$ が 0 に近づくため、項全体が報酬として機能してしまいます。

---

## 3. 新案コスト考慮損失 (New CSL)
間違いクラスを「否定」する形式。数学的に最も安定します。

$$Loss_{new} = -(a \log P_{correct} + \sum b_j \log(1 - P_{wrong, j}))$$

> **利点**: $P_{wrong} \to 1$ のとき、$\log(1 - P_{wrong}) \to \log(0)$ となり、マイナス無限大へ発散します。先頭のマイナスにより、ロスは **プラス無限大（爆発的な罰金）** となります。

---

## 数学的挙動の比較

| 関数 | $P_{wrong} \to 1$ 時の挙動 | AIの反応 |
| :--- | :--- | :--- |
| **通常のCE** | ロスが微増（正解が減るため） | 正解を探す |
| **旧型 (a < b)** | **ロスがマイナス無限大へ発散** | **積極的に間違える** |
| **新型 (CSL)** | **ロスがプラス無限大へ発散** | **その間違いを絶対避ける** |
